<%- include('../partials/header') %>
<section class="flow-hero mb-4">
  <p class="kicker mb-2">Checkout</p>
  <h1 class="h3 mb-1">Delivery details</h1>
  <p class="text-muted mb-0">
    Confirm your shipping info, then choose a payment method.
  </p>
</section>

<section class="row g-4 align-items-start">
  <div class="col-lg-7">
    <form action="/checkout" method="POST" class="card shadow-sm flow-card">
      <div class="card-body">
        <div
          class="d-flex align-items-center justify-content-between flex-wrap gap-2"
        >
          <h2 class="h5 mb-0">Shipping</h2>
          <span class="pill">Step 1 of 2</span>
        </div>

        <div class="flow-divider"></div>

        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label">Full name</label>
            <input
              class="form-control"
              type="text"
              name="shippingName"
              required
            />
          </div>
          <div class="col-md-6">
            <label class="form-label">Phone</label>
            <input
              class="form-control"
              type="text"
              name="shippingPhone"
              required
            />
          </div>
          <div class="col-12">
            <label class="form-label">Address</label>
            <input
              class="form-control"
              type="text"
              name="shippingAddress"
              required
            />
          </div>
          <div class="col-12">
            <label class="form-label">Notes (optional)</label>
            <textarea
              class="form-control"
              name="notes"
              rows="3"
              placeholder="Gate code, preferred delivery time, etc."
            ></textarea>
          </div>
        </div>

        <div class="flow-divider"></div>

        <div
          class="d-flex align-items-center justify-content-between flex-wrap gap-2"
        >
          <h3
            class="h6 text-uppercase text-muted mb-0"
            style="letter-spacing: 0.18em"
          >
            Payment
          </h3>
          <span class="pill">Step 2 of 2</span>
        </div>
        <p class="text-muted mt-2 mb-3">
          QR payment continues to a separate page with the QR code and your
          order total.
        </p>

        <div class="payment-choice">
          <div class="payment-choice__qr">
            <div
              class="d-flex align-items-start justify-content-between gap-3 flex-wrap"
            >
              <div>
                <p class="mb-1 fw-semibold">Pay via QR</p>
                <p class="mb-0 text-muted small">
                  Continue to the QR page, scan, then confirm payment to start
                  shipping.
                </p>
              </div>
              <img
                class="checkout-qr__image"
                src="/images/qr-pay.svg"
                alt="QR payment preview"
                loading="lazy"
              />
            </div>
          </div>

          <div class="mt-3 d-flex flex-wrap gap-2 justify-content-end">
            <button
              class="btn btn-outline-secondary"
              type="submit"
              name="paymentMethod"
              value="cod"
            >
              Place order (Cash)
            </button>
            <button
              class="btn btn-primary"
              type="submit"
              name="paymentMethod"
              value="qr"
            >
              Continue to QR payment
            </button>
          </div>
        </div>
      </div>
    </form>
  </div>

  <div class="col-lg-5">
    <div class="card shadow-sm flow-card flow-sticky">
      <div class="card-body">
        <div class="d-flex align-items-center justify-content-between">
          <h2 class="h5 mb-0">Order summary</h2>
          <a class="btn btn-outline-secondary btn-sm" href="/cart">Edit cart</a>
        </div>
        <div class="flow-divider"></div>
        <ul class="list-group list-group-flush">
          <% cart.forEach((item) => { %>
          <li class="list-group-item d-flex justify-content-between">
            <span><%= item.name %> Ã— <%= item.quantity %></span>
            <strong>$<%= (item.quantity * item.price).toFixed(2) %></strong>
          </li>
          <% }); %>
        </ul>
        <div class="d-flex justify-content-between mt-3">
          <span>Total</span>
          <strong>$<%= total.toFixed(2) %></strong>
        </div>
      </div>
    </div>
  </div>
</section>
<%- include('../partials/footer') %>
