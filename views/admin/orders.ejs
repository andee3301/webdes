<%- include('../partials/header') %>
<section class="d-flex justify-content-between align-items-center mb-3">
  <div>
    <h1 class="h4 mb-0">Orders</h1>
    <p class="text-muted mb-0">Manage customer orders.</p>
  </div>
  <form class="d-flex align-items-center gap-2" method="GET" action="/admin/orders">
    <label class="form-label mb-0 small text-muted">Status</label>
    <select class="form-select" name="status" onchange="this.form.submit()">
      <option value="all" <%= filterStatus === 'all' ? 'selected' : '' %>>All</option>
      <option value="pending" <%= filterStatus === 'pending' ? 'selected' : '' %>>Pending</option>
      <option value="confirmed" <%= filterStatus === 'confirmed' ? 'selected' : '' %>>Confirmed</option>
      <option value="shipped" <%= filterStatus === 'shipped' ? 'selected' : '' %>>Shipped</option>
      <option value="completed" <%= filterStatus === 'completed' ? 'selected' : '' %>>Completed</option>
      <option value="cancelled" <%= filterStatus === 'cancelled' ? 'selected' : '' %>>Cancelled</option>
    </select>
  </form>
</section>

<div class="table-responsive shadow-sm">
  <table class="table table-striped align-middle mb-0">
    <thead>
      <tr>
        <th>ID</th>
        <th>Customer</th>
        <th>Status</th>
        <th>Total</th>
        <th>Placed</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <% if (!orders.length) { %>
      <tr>
        <td colspan="6" class="text-center text-muted">No orders found.</td>
      </tr>
      <% } %> <% orders.forEach((order) => { %>
      <tr>
        <td>#<%= order.id %></td>
        <td><%= order.user?.name %> <br /><small class="text-muted"><%= order.user?.email %></small></td>
        <td>
          <span class="badge text-uppercase <%= orderStatusBadgeClass(order.status) %>">
            <%= orderStatusLabel(order.status) %>
          </span>
        </td>
        <td>$<%= parseFloat(order.totalPrice).toFixed(2) %></td>
        <td><%= new Date(order.createdAt).toLocaleString() %></td>
        <td class="text-end">
          <a class="btn btn-sm btn-outline-primary" href="/admin/orders/<%= order.id %>">Details</a>
        </td>
      </tr>
      <% }); %>
    </tbody>
  </table>
</div>
<%- include('../partials/footer') %>
